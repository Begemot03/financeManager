import{_ as B,s as D,a as U,b as k}from"./categoryModel-su6EkKw0.js";import{d as w,u as T,t as I,g as x,C as $,e as V,a as N,h as O}from"./uuid-CkBbJNVX.js";import{u as R,b as y,s as L,c as E,a as j,_ as q}from"./NewOperationModal.vue_vue_type_script_setup_true_lang-CTeT1X5U.js";import{p as v,o as b,e as z,m as A,v as t,D as C,q as g,C as F,c as h,x as s,w as f,F as G,g as p,E as H,t as S,n as J}from"./index-B4EVAOy-.js";const K=v({__name:"MoneyTransfer",props:{label:{}},setup(d){const e=M(),u=d;return(a,c)=>{const o=w;return b(),z(o,A(u,{loading:t(e).loading,severity:"contrast",type:"submit"}),null,16,["loading"])}}}),M=C("moneyTransfer",()=>{const d=T(),e=g(!1);async function u(a){e.value=!0;try{await I(1500),await d.getOperationList(),d.operations.push({id:x(),depositeId:a.depositeTo,name:"Перевод",type:"Доход",sum:a.sum,category:"Переводы",currency:$.RUB}),d.operations.push({id:x(),depositeId:a.depositeFrom,name:"Перевод",type:"Расход",sum:a.sum,category:"Переводы",currency:$.RUB})}catch(c){console.log(`Error on money transfer: ${c}`)}finally{e.value=!1}}return{loading:e,transfer:u}}),Q=C("newMoneyTransferModal",()=>{const d=g(!1),e=V(),u=F(()=>e.deposites.map(r=>({name:r.name,id:r.id}))),{handleSubmit:a,handleReset:c}=R({initialValues:{},validationSchema:{sum(r){return r>0?!0:"Введите число больше 0"},depositeFrom(r){return u.value.find(l=>l.id===r)?!0:"Выберите депозит из списка."},depositeTo(r){return u.value.find(l=>l.id===r)?!0:"Выберите депозит из списка."}}}),o=y("sum"),i=y("depositeFrom"),m=y("depositeTo");function _(){d.value=!0}function n(){d.value=!1}return{sum:o,depositeFrom:i,depositeTo:m,handleReset:c,handleSubmit:a,listOfDeposites:u,visible:d,open:_,close:n}}),W={class:"flex gap-2 mb-4"},X={class:"mb-4"},Y={class:"flex justify-end gap-2"},Z=v({__name:"NewMoneyTransferModal",setup(d){const e=Q(),u=M(),a=e.handleSubmit(async c=>{await u.transfer(c),e.handleReset(),e.close()});return(c,o)=>{const i=w,m=N,_=O,n=E,r=L;return b(),h(G,null,[s(i,{label:"Перевод между счетами",onClick:t(e).open,severity:"secondary"},null,8,["onClick"]),s(r,{visible:t(e).visible,"onUpdate:visible":o[4]||(o[4]=l=>t(e).visible=l),header:"Перевод",class:"w-96","pt:content:class":"!overflow-y-visible",modal:""},{default:f(()=>[p("form",{onSubmit:o[3]||(o[3]=H((...l)=>t(a)&&t(a)(...l),["prevent"]))},[p("div",W,[s(m,{modelValue:t(e).depositeFrom.value,"onUpdate:modelValue":o[0]||(o[0]=l=>t(e).depositeFrom.value=l),options:t(e).listOfDeposites,optionLabel:"name",optionValue:"id",placeholder:"Откуда",class:"w-full"},null,8,["modelValue","options"]),s(m,{modelValue:t(e).depositeTo.value,"onUpdate:modelValue":o[1]||(o[1]=l=>t(e).depositeTo.value=l),options:t(e).listOfDeposites,optionLabel:"name",optionValue:"id",placeholder:"Куда",class:"w-full"},null,8,["modelValue","options"])]),p("div",X,[s(n,{variant:"on"},{default:f(()=>[s(_,{modelValue:t(e).sum.value,"onUpdate:modelValue":o[2]||(o[2]=l=>t(e).sum.value=l),modelModifiers:{trim:!0},id:"sum",class:"w-full",inputId:"integeronly"},null,8,["modelValue"]),o[5]||(o[5]=p("label",{for:"sum"},"Сумма перевода",-1))]),_:1})]),p("div",Y,[s(i,{label:"Закрыть",severity:"secondary",onClick:t(e).close},null,8,["onClick"]),s(t(K),{label:"Перевести"})])],32)]),_:1},8,["visible"])],64)}}}),P={class:"flex gap-4 flex-col md:flex-row items-start"},ee={class:"flex gap-2 flex-col"},ne=v({__name:"TransactionsPage",setup(d){const e=T(),u=V(),a=g([]),c=F(()=>a.value.length==0?e.operations:e.operations.filter(o=>a.value.some(i=>i.name==o.category)));return(o,i)=>{const m=k,_=D;return b(),h("div",P,[p("div",ee,[s(t(j)),s(t(q)),s(Z),s(t(B),{selected:a.value,"onUpdate:selected":i[0]||(i[0]=n=>a.value=n)},null,8,["selected"])]),s(_,{value:c.value,"removable-sort":"",class:"w-full"},{header:f(()=>i[1]||(i[1]=[p("span",{class:"font-bold text-xl"},"Расходы",-1)])),empty:f(()=>i[2]||(i[2]=[p("div",{class:"font-bold text-center"},"Вы пока не тратили",-1)])),default:f(()=>[s(m,{field:"name",header:"Название операции"}),s(m,{field:"sum",header:"Сумма операции",sortable:""},{body:f(n=>[p("span",{class:J({"text-primary":n.data.type=="Доход","text-red-700":n.data.type!="Доход"})},S(`${n.data.type=="Доход"?"+":"-"} ${n.data.sum} RUB`),3)]),_:1}),s(m,{field:"category",header:"Категория"},{body:f(n=>[s(t(U),{name:n.data.category,type:n.data.type},null,8,["name","type"])]),_:1}),s(m,{field:"depositeId",header:"Депозит"},{body:f(n=>{var r;return[p("div",null,S((r=t(u).deposites.find(l=>l.id===n.data.depositeId))==null?void 0:r.name),1)]}),_:1})]),_:1},8,["value"])])}}});export{ne as default};
